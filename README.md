# jjpred

## Documentation

See documentation [here](https://bzm3r.codeberg.page/jjpred).

## General Design

In order to make understanding and using the program as easy as possible, this project makes some opinionated choices, please bear with them while you can and if they cause trouble to an unbearable degree, it should generally not take more than a day's work to revert any of these choices:

- uses [`uv`](https://docs.astral.sh/uv/) to easily manage required dependencies because:
  - `conda` etc. are a waste of time and energy, while `uv` _just works_
- uses `polars` instead of `pandas`, because:
  - my laptop only had 6 GB of RAM; between VS Code being open, and sometimes the browser:
    - the laptop was unable to handle `pandas` memory usage
    - `pandas`'s Excel file reader (at the time at least), could not open the main FBA review program on my laptop
  - `polars` is much faster
  - `polars` provides good type hinting, helpful for documentation/development as noted above
  - `polars` can take a `pandas` dataframe as input, or convert a `polars` dataframe into a `pandas` dataframe, so there is full inter-operability
  - `polars` can save a dataframe in any kind of required format, from `.csv` to `.parquet` etc.
- uses Python's type hinting system, because:
  - documentation: you'll have a good idea of what a function needs to take by looking at the type of inputs it requires
  - development experience: the editor, if configured correctly, will provide some errors about a function getting the wrong type, etc.

## Setting up the repository

### Editor

VS Code is the recommended editor for manipulating this project, and various helpful settings are provided in the `.vscode` folder in order to ease setup/usage. For example:

- recommended VS code extensions for working with Python
- the default Python interpreter automatically looks for the `.venv` folder (set up using `rye`, see below)
- a definition for running a Python debug action (under `launch.json`)

### Project setup

#### Installing `uv`

**Note:** if you are on Windows, make sure to [enable developer mode](https://rye.astral.sh/guide/faq/#windows-developer-mode).

- Install [`uv`](https://docs.astral.sh/uv/getting-started/installation/#winget)
- run `uv sync`
- **unnecessary unless you really need to**:
  - to activate the virtual environment created by `uv` manually (e.g. within a terminal), [follow the typical instructions for activating a virtual environment](https://docs.python.org/3/tutorial/venv.html); in this project's case, the virtual environment folder is called `.venv` (automatically created by `rye`), so you would run
    - (if on Linux): `source ./.venv/bin/activate`
    - (if on Windows): `./jjpred-project/.venv/Scripts/Activate.ps1`

1. Create a subfolder named `AnalysisInput`

   - download relevant Excel files into `AnalysisInput`

     - **note:** you will need to attach a date of some sort to each file, preferably in `2023-SEP-09` style format, I have a folder where I have attached such dates
     - **TODO**: come up with a better system for how files+dates are managed

   - the following files are required:

     - **required**: master SKU file (for getting information about which SKUs are active, which active SKUs are paused, their season history, etc.)
     - **required**: `All Marketplace All SKU` file (for getting historical sales information and channel stock information)
       - optionally, you can use the `Historical sales and inv.` file instead if for some you have that, but not `All Marketplace All SKU`
     - **required**: category focus file (the configuration file from the marketing team)
     - **required**: `prediction_types.csv` file which lists out the default predicition mode to use for a category, based on its season and the time of the year when we are making a prediction

   - the following files are optional:
     - (optional) "historical" file, containing the `MonSaleR` sheet (required if you want to confirm which reference categories/reference channels/historical years are being used by the main program, or if you want to compare monthly sales ratios calculated by this program vs. the Excel sheet)
     - (optional) FBA inventory optimization file if you want to
       - compare with data in the main program
       - get box quantity information
     - (optional) refill draft plan file if you want to
       - compare against an actual dispatch

2. Create a subfolder named `AnalysisOutput` this is where
   - files generated by the analysis will be emitted
   - files required by the analysis will be placed
     - e.g. qty box information in the future will not be read from the main program excel sheet

## Building the Documentation

**NOTE:** Do not run the PowerShell/bash scripts provided to autogenerate the documentation unless you have tried it once yourself manually.

Check out [makedocs.ps1](./makedocs.ps1) (if using Windows + PowerShell) or [makedocs.sh](./makedocs.sh) (if using Linux or WSL) for the sequence of commands you should follow in order to build the documentation.
